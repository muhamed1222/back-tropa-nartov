-- Скрипт для добавления тестовых данных в Strapi через SQL
-- Запуск: docker-compose exec postgres psql -U postgres -d tropa_nartov -f /path/to/add_data_via_sql.sql

-- Добавляем районы (areas)
INSERT INTO areas (name, description, created_at, updated_at) VALUES
('Приэльбрусье', 'Район вокруг горы Эльбрус', NOW(), NOW()),
('Домбай', 'Домбайский район', NOW(), NOW()),
('Архыз', 'Архызский район', NOW(), NOW()),
('Чегемское ущелье', 'Чегемское ущелье', NOW(), NOW())
ON CONFLICT (name) DO NOTHING;

-- Добавляем категории (categories)
INSERT INTO categories (name, description, created_at, updated_at) VALUES
('Достопримечательности', 'Интересные места для посещения', NOW(), NOW()),
('Природа', 'Природные объекты', NOW(), NOW()),
('Культура', 'Культурные объекты', NOW(), NOW()),
('Развлечения', 'Места для развлечений', NOW(), NOW())
ON CONFLICT (name) DO NOTHING;

-- Добавляем типы (types)
INSERT INTO types (name, entity_type, description, created_at) VALUES
('Пеший поход', 'route', 'Пешие маршруты по горам и лесам', NOW()),
('Веломаршрут', 'route', 'Велосипедные трассы', NOW()),
('Автомобильный', 'route', 'Маршруты для автомобильных поездок', NOW())
ON CONFLICT (name) DO NOTHING;

-- Получаем ID для использования
DO $$
DECLARE
    area_id_1 INTEGER;
    type_id_1 INTEGER;
BEGIN
    -- Получаем ID района Приэльбрусье
    SELECT id INTO area_id_1 FROM areas WHERE name = 'Приэльбрусье' LIMIT 1;
    
    -- Получаем ID типа Пеший поход
    SELECT id INTO type_id_1 FROM types WHERE name = 'Пеший поход' LIMIT 1;
    
    -- Добавляем места (places) - используем существующую таблицу places
    INSERT INTO places (name, type, description, overview, history, address, hours, weekend, entry, contacts, contacts_email, latitude, longitude, rating, type_id, area_id, is_active, created_at, updated_at) VALUES
    ('Парк Атажукинский', 'парк', 'Крупнейший парк на Северном Кавказе с богатой растительностью', 'Площадь 250 гектаров, аллеи, фонтаны, озера, зоопарк и развлечения', 'Заложен в 1847 году как Казенный сад, современное название получил в 1920 году', 'г. Нальчик, ул. Толстого, 2', '06:00-24:00', 'Без выходных', 'Свободный', '+78662225566', 'park@nalchik.ru', 43.4925, 43.6123, 4.8, COALESCE(type_id_1, 1), COALESCE(area_id_1, 1), true, NOW(), NOW()),
    ('Кафе "Горный Ветерок"', 'кафе', 'Уютное кафе с кавказской кухней и прекрасным видом', 'Традиционные блюда кавказской кухни, свежая выпечка, кофе по-восточному', 'Основано в 1995 году, с тех пор является одним из любимых мест жителей и гостей города', 'г. Нальчик, пр. Ленина, 25', '08:00-23:00', 'Без выходных', 'Свободный', '+78662223344', 'gorniy-veterok@mail.ru', 43.4981, 43.7189, 4.5, COALESCE(type_id_1, 1), COALESCE(area_id_1, 1), true, NOW(), NOW()),
    ('Музей Кабардино-Балкарии', 'музей', 'Национальный музей с богатой коллекцией истории и культуры народов КБР', 'Экспозиции по археологии, этнографии, искусству и современной истории', 'Основан в 1921 году, в фондах более 150 тысяч экспонатов', 'г. Нальчик, ул. Горького, 62', '10:00-18:00', 'Понедельник', 'Платный', '+78662227788', 'museum@kbr.ru', 43.5050, 43.6250, 4.2, COALESCE(type_id_1, 1), COALESCE(area_id_1, 1), true, NOW(), NOW()),
    ('Ресторан "Эльбрус"', 'ресторан', 'Ресторан национальной кухни с кавказским гостеприимством', 'Блюда кабардинской, балкарской и общекавказской кухни, живая музыка', 'Работает с 1985 года, известен своими шеф-поварами и качеством обслуживания', 'г. Нальчик, ул. Кабардинская, 45', '11:00-02:00', 'Без выходных', 'Свободный', '+78662229900', 'elbrus-rest@yandex.ru', 43.4900, 43.6300, 3.9, COALESCE(type_id_1, 1), COALESCE(area_id_1, 1), true, NOW(), NOW()),
    ('Сквер "Дружбы"', 'парк', 'Уютный сквер в центре города для прогулок и отдыха', 'Благоустроенная территория с фонтаном, скамейками и детской площадкой', 'Создан в 1970-х годах в честь дружбы народов Кавказа', 'г. Нальчик, пл. Согласия', 'Круглосуточно', 'Без выходных', 'Свободный', '', '', 43.5100, 43.6100, 4.0, COALESCE(type_id_1, 1), COALESCE(area_id_1, 1), true, NOW(), NOW())
    ON CONFLICT DO NOTHING;
    
    -- Добавляем маршруты (routes)
    INSERT INTO routes (name, description, overview, history, distance, duration, type_id, area_id, rating, is_active, created_at, updated_at) VALUES
    ('Восхождение на Эльбрус', 'Легендарный маршрут к высочайшей точке Европы через живописные ледники и горные перевалы', 'Маршрут начинается от поселка Терскол и проходит через приют Бочки, скалы Пастухова до западной вершины Эльбруса', 'Первое успешное восхождение на Эльбрус было совершено в 1829 году экспедицией Российской академии наук под руководством генерала Г. А. Эммануэля', 22.5, 48.0, COALESCE(type_id_1, 1), COALESCE(area_id_1, 1), 4.9, true, NOW(), NOW()),
    ('Чегемские водопады', 'Путь к величественным водопадам в живописном Чегемском ущелье, известному своими суровыми скалами и бурной рекой', 'Маршрут проходит вдоль реки Чегем через несколько каскадов водопадов, самый известный из которых - Девичьи косы', 'Чегемское ущелье издавна было заселено балкарцами, о чем свидетельствуют древние склепы и башни', 8.2, 4.5, COALESCE(type_id_1, 1), (SELECT id FROM areas WHERE name = 'Чегемское ущелье' LIMIT 1), 4.7, true, NOW(), NOW())
    ON CONFLICT DO NOTHING;
END $$;

-- Выводим результат
SELECT 'Данные успешно добавлены!' as status;
SELECT COUNT(*) as places_count FROM places;
SELECT COUNT(*) as routes_count FROM routes;
SELECT COUNT(*) as areas_count FROM areas;
SELECT COUNT(*) as categories_count FROM categories;
SELECT COUNT(*) as types_count FROM types;

